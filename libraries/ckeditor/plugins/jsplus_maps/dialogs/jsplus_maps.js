CKEDITOR.dialog.add("jsplus_maps",function(a){return{title:"JS+ Google Maps",resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minHeight:550,contents:[{id:"preview",label:"1111",elements:[{type:"html",id:"previewHtml",html:'<iframe src="'+a.path+"dialogs/jsplus_maps.html"+'" style="width: 100%; height: '+540+'px" hidefocus="true" frameborder="0" '+'id="cke_docProps_preview_iframe"></iframe>',}]}],onShow:function(b){var c=window.jsplus_maps_img;if(c&&c.is("img")&&c.$.className=="jsplus_maps_img"){this.parts.title.$.innerHTML="Edit map";try{CKEDITOR.config.jsplus_maps_current=JSON.parse(decodeURIComponent(c.$.getAttribute("data_script")));}catch(d){CKEDITOR.config.jsplus_maps_current=null;}CKEDITOR.config.jsplus_maps_current&&loadMapFromJSON(CKEDITOR.config.jsplus_maps_current);}else{this.parts.title.$.innerHTML="Insert new map";try{loadMapFromJSON({lat:CKEDITOR.config.jsplus_maps_default_x,lng:CKEDITOR.config.jsplus_maps_default_y,zoom:CKEDITOR.config.jsplus_maps_default_zoom,type:"roadmap",width:CKEDITOR.config.jsplus_maps_width,height:CKEDITOR.config.jsplus_maps_height,"settings":{"disableDefaultUI":0,"disableDoubleClickZoom":0,"draggable":1,"mapTypeControl":1,"zoomControl":1,"rotateControl":0,"scaleControl":0,"streetViewControl":0,"panControl":0,"overviewMapControl":0}});}catch(d){}}},onLoad:function(){this.on("resize",function(b){document.getElementById("cke_docProps_preview_iframe").style.height=b.data.height+"px";triggerResize&&triggerResize.call&&triggerResize(b.data.height-60);});},onOk:function(b){var c='<img class="jsplus_maps_img" contenteditable="false" data_script="'+encodeURIComponent(JSON.stringify(generateCodeMap()))+'" src="'+generateStatMap(generateCodeMap())+'"/>';var d=CKEDITOR.dom.element.createFromHtml(c);if(window.jsplus_maps_img==null){CKEDITOR.currentInstance.insertElement(d);}else{window.jsplus_maps_img.$.parentElement.insertBefore(d.$,window.jsplus_maps_img.$);window.jsplus_maps_img.$.parentElement.removeChild(window.jsplus_maps_img.$);}},onHide:function(){window.jsplus_maps_img=null;}};});